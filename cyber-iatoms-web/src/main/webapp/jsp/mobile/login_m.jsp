<!doctype html><%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%><%@ page import="com.cybersoft4u.xian.iatoms.common.IAtomsMessageCode"%><%@include file="/jsp/common/meta.jsp"%><%@include file="/jsp/mobile/mobile-common.jsp"%><html><head>	<link rel="shortcut icon" href="assets/img/cyber.ico" type="image/gif" />     <script type="text/javascript" language="JavaScript" defer="defer">	//<!--登入失敗彈出登入失敗錯誤訊息 -->	function init(){		var status = '${message.status}';		var code = '${message.code}';		if (status =='<%=Message.STATUS.FAILURE%>'){			alertErrorCommon("<spring:message code='${message.code}' arguments='${message.argumentList}'/>", function(){				$('#userCode').textbox('textbox').focus();			});		} else if (status =='<%=Message.STATUS.SUCCESS%>') {			//錯誤處理, 提示			var msgDesc = "<spring:message code='${message.code}' arguments='${message.argumentList}'/>";		}		initUserCookie();		return;	}		//<!--登錄-->	function login(){		var loginform = $("#loginform");		var validate = loginform.form('enableValidation').form('validate');		if (validate) {			saveUserCookie('<%=IAtomsLogonUser.FIELD_USER_CODE%>');			var blockStyle = {message:'loading...',fadeIn:0,fadeOut:0,css:{width:'150px',top:'40%',left:'40%',height:'50px',border:'3px solid #95B8E7',lineHeight:'50px'},overlayCSS:{backgroundColor:'#aaa',cursor:'default'}};			$.blockUI(blockStyle);			loginform.get(0).submit();		}	}	//<!--关闭视窗讯息-->	window.onbeforeunload = myunload;	function myunload(event)	{	    if(event.clientX > document.body.clientWidth && event.clientY < 0 || event.altKey)	    {	        window.event.returnValue = "確認離開";//關閉時,彈出視窗的訊息	    }	}	//按下回车键登入	$(function() {	//	$('#userCode').textbox().next('span').find('input').focus();		//$('#userCode').textbox('textbox').focus();  		//Bug #2137	//	$("#loginform").form('enableValidation').form('validate');		$("#loginform input").keypress(function(event){  			if (event.keyCode == 13){				login();			}		});				// client信息		$('#operatingSystem').val('作業系統:' + $.client.os);		$('#browser').val('瀏覽器:' + $.client.browser);		$('#version').val('瀏覽器版本:' + $.client.browser + " " + $.client.version);		$('#showWidth').val('視窗寬度:' + $(window).width() + 'px');		$('#showHeight').val('視窗高度:' + $(window).height() + 'px');	});		function initUserCookie(){		$('#<%=IAtomsLogonUser.FIELD_USER_CODE%>').combobox({ 	    	editable:true,  	    	panelHeight:'auto',		    valueField:'value',		    textField:'name',		    method:'get',		    hasDownArrow:false,		    required:true,		    validType:'maxLength[20]',		    missingMessage:"請輸入帳號",	      	invalidMessage:"請輸入帳號",	      	prompt:'Username',validType:['maxLength[20]'],iconCls:'icon-man',iconWidth:38		});		$('#<%=IAtomsLogonUser.FIELD_USER_CODE%>').addClass("easyui-combobox");		//Task 使用 autocomplete 效果，CLIET記住輸入內容		try {			//如果cookie中存在該值			var cookie = $.cookie('<%=IAtomsLogonUser.FIELD_USER_CODE%>');			if (cookie!=null) {				$("#<%=IAtomsLogonUser.FIELD_USER_CODE%>").combobox('loadData', JSON.parse(cookie));			}			$("#<%=IAtomsLogonUser.FIELD_USER_CODE%>").combobox('setValue', '');			$('#<%=IAtomsLogonUser.FIELD_USER_CODE%>').combobox('textbox').bind('focus.showPanel',function(){  				$('#<%=IAtomsLogonUser.FIELD_USER_CODE%>').combobox('showPanel');  			}); 		} catch (e) {			$.cookie('<%=IAtomsLogonUser.FIELD_USER_CODE%>', null);		}	}	/*	 * 保存cookie	 */	function saveUserCookie(id){		var result = null;		var val = null;		try {			//如果cookie中存在該值			var cookie = $.cookie(id);			if (cookie != null) {				result = JSON.parse(cookie);				//轉化為json格式，去除重複				val = $("#" +id).combobox('getValue');				if (val && $.trim(val).length > 0) {									var repeate = false;					for (j = 0; j < result.length; j ++) {						if (result[j].value == $.trim(val)) {							repeate = true;							break;						}										}					if (!repeate) {						result.push({value : $.trim(val), name : $.trim(val)});					}				}				 $("#" + id).combobox('loadData', result);				 //將值寫入cookie之中				 $.cookie(id,JSON.stringify(result));						} else {				val = $("#"+id).combobox('getValue');				result='[{"value":"'+$.trim(val)+'","name":"'+$.trim(val)+'"}]';				$.cookie(id ,result);			} 		} catch(e) {			$.cookie(id,null);		}	}		</script></head><body class="easyui-layout" onload="init();">	<div class="easyui-navpanel">		<header>			<div class="m-toolbar">				<span class="m-title">Welcome To Mobile iATOMS</span>			</div>		</header>		<div style="margin:20px auto;width:100px;height:100px;overflow:hidden">			<img src="assets/img/logo.png" style="margin:0">		</div>		<div style="padding:0 20px">			<form name="loginform" id="loginform" autocomplete ="off" ACTION="${contextPath}/mlogon.do" method="POST">			<div style="margin-bottom:10px">				<cafe:droplisttag 		               id="<%=IAtomsLogonUser.FIELD_USER_CODE%>"		               name="<%=IAtomsLogonUser.FIELD_USER_CODE%>" 		               hasBlankValue="false"		               style="width:100%; height: 40px; padding: 12px"		               >	            </cafe:droplisttag>			</div>			<div>				<input id="logUserPwd" 							name="logUserPwd" 				            class="easyui-textbox" 				            setting="hidden"				            type="password" value=""				            style="width: 100%; height: 40px; padding: 12px"				            required="true" missingMessage="請輸入密碼" maxlength="20"				            data-options="prompt:'Password',validType:['maxLength[20]'],iconCls:'icon-lock',iconWidth:38">			</div>			<div style="text-align:center;margin-top:30px">				<input type="hidden" id="passwordIgnoreFlag" name="passwordIgnoreFlag"/>					<a id="logon"  class="easyui-linkbutton" data-options="iconCls:'icon-ok'" 						onclick="login()" style="padding: 5px 0px; width: 100%;">						<span>登入系統</span>					</a>				<!-- client信息隱藏域 -->				<input type="hidden" id="operatingSystem" name="operatingSystem"/>				<input type="hidden" id="browser" name="browser"/>				<input type="hidden" id="version" name="version"/>				<input type="hidden" id="showWidth" name="showWidth"/>				<input type="hidden" id="showHeight" name="showHeight"/>							</div>			<div style="text-align:center;margin-top:30px">					        </div>			</form>		</div>	</div></body>	</html>